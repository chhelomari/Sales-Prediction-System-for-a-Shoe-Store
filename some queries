-- 1. Most sold shoe type
SELECT Type, SUM(Quantity) AS TotalSold
FROM SalesTransactions
JOIN Shoes ON SalesTransactions.ShoeID = Shoes.ShoeID
GROUP BY Type
ORDER BY TotalSold DESC
LIMIT 1;

-- 2. Sales by month
SELECT MONTH(SaleDate) AS Month, SUM(Quantity) AS TotalSold
FROM SalesTransactions
GROUP BY MONTH(SaleDate);

-- 3. Top customers
SELECT Customers.Name, SUM(TotalPrice) AS TotalSpent
FROM SalesTransactions
JOIN Customers ON SalesTransactions.CustomerID = Customers.CustomerID
GROUP BY Customers.Name
ORDER BY TotalSpent DESC;

-- 4. Stock prediction
SELECT Brand, Type, StockQuantity, SUM(Quantity) AS Sold, 
(StockQuantity - SUM(Quantity)) AS Remaining
FROM SalesTransactions
JOIN Shoes ON SalesTransactions.ShoeID = Shoes.ShoeID
GROUP BY Brand, Type, StockQuantity;

-- 5. Promotion impact
SELECT Description, COUNT(SaleID) AS SalesCount, SUM(TotalPrice) AS Revenue
FROM Promotions
JOIN SalesTransactions 
ON SaleDate BETWEEN StartDate AND EndDate
GROUP BY Description;
